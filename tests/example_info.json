{
  "name": "nvim",
  "depends": {
    "arch_linux": ["neovim-git", "ripgrep", "git"],
    "alpine": ["neovim-git", "ripgrep", "alpine-sdk", "git"]
  },
  "sources": [
    { "path": "./*" },
    {
      "alias": "SomePatch",
      "url": "https://github.com/SomeBody/SomePlugin/pull/114514.diff"
    },
    {
      "alias": "extra",
      "git": "https://github.com/SomeBody/ExtraPlugin.git"
    }
  ],

  "steps": [
    {
      "name": "prepare",
      "env": {
        "extra-key": "reusable-value",
        "packer_dir":  "~/.local/share/nvim/site/pack/packer/opt/"
      },
      "actions": [
        {"mkdir": ["~/.config", "$packer_dir", "~/.cache"]},
        {"copy": ["./extra", "$packer_dir"]}
      ]
    },
    {
      "name": "install",
      "env": {
        "nvim_cfg_dir": "~/.config/nvim"
      },
      "actions": [
        { "symlink": ["$srcdir", "nvim_cfg_dir"] },
        { "execute": ["cd ~/.config/nvim", "patch -p0 -Ni ${src_dir}/SomePatch" ] },
        { "copy": ["${nvim_cfg_dir}/custom.example.lua", "${nvim_cfg_dir}/custom.lua"]}
      ]
    },
    {
      "name": "post-install",
      "actions": [
        {"execute": ["nvim --headless -c 'autocmd User PackerComplete quitall'"]}
      ]
    }
  ]
}
